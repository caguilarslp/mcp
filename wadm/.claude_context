# ğŸ¤– WADM - wAIckoff Data Manager Context

## ğŸ“‹ Estado Actual
- **VersiÃ³n:** v0.1.0
- **Fecha:** 17/06/2025
- **Status:** Desarrollo Activo - Volume Profile Service Completado
- **Fase Actual:** Desarrollo - 50% completado (4/8 tareas)
- **Ãšltima Tarea:** [TASK-004] Volume Profile Service âœ…

## ğŸ¯ Objetivo del Proyecto
Sistema de recolecciÃ³n y distribuciÃ³n de indicadores de mercado (Volume Profile y Order Flow) para alimentar el ecosistema wAIckoff con datos procesados de alta calidad.

## ğŸ—ï¸ Arquitectura
- **VPS con Docker**: Collectors (Binance/Bybit) â†’ MongoDB â†’ MCP Server
- **Clientes locales**: MCP Client â†’ Cache en waickoff_reports/indicators/
- **Seguridad**: API Keys + HTTPS + MongoDB interno (solo localhost)
- **Simplicidad**: Un solo requirements.txt, Docker Compose optimizado

## ğŸ“ Estructura del Proyecto
```
wadm/
â”œâ”€â”€ claude/              # Sistema completo de trazabilidad
â”‚   â”œâ”€â”€ master-log.md   # Log principal del proyecto
â”‚   â”œâ”€â”€ tasks/          # GestiÃ³n de tareas
â”‚   â”œâ”€â”€ adr/           # Architecture Decision Records
â”‚   â”œâ”€â”€ docs/          # DocumentaciÃ³n tÃ©cnica nueva
â”‚   â”‚   â”œâ”€â”€ arquitectura-simplificada.md
â”‚   â”‚   â”œâ”€â”€ deployment-vps.md
â”‚   â”‚   â””â”€â”€ api-reference.md
â”‚   â”œâ”€â”€ logs/          # Logs diarios
â”‚   â”œâ”€â”€ bugs/          # Bug tracking
â”‚   â””â”€â”€ lessons-learned/ # Conocimiento acumulado
â”œâ”€â”€ docs/               # DocumentaciÃ³n tÃ©cnica
â”‚   â”œâ”€â”€ trazabilidad/  # Sistema anterior (migrado)
â”‚   â””â”€â”€ arquitectura/  # DiseÃ±os tÃ©cnicos
â”œâ”€â”€ docker/            # Docker Compose y configs
â”œâ”€â”€ src/               # CÃ³digo fuente
â”‚   â”œâ”€â”€ core/          # Entidades y tipos
â”‚   â”œâ”€â”€ infrastructure/ # Collectors y base de datos
â”‚   â”‚   â”œâ”€â”€ collectors/ # WebSocket collectors
â”‚   â”‚   â”œâ”€â”€ database/  # MongoDB schemas y repositorios
â”‚   â”‚   â””â”€â”€ cache/     # Redis cache especializado
â”‚   â”œâ”€â”€ application/   # Casos de uso y servicios
â”‚   â”‚   â”œâ”€â”€ services/  # VolumeProfileService
â”‚   â”‚   â””â”€â”€ use_cases/ # Clean Architecture use cases
â”‚   â””â”€â”€ presentation/  # API y MCP
â”‚       â””â”€â”€ api/routes/ # REST endpoints
â”œâ”€â”€ tests/             # Tests unitarios
â”‚   â”œâ”€â”€ infrastructure/ # Tests de infrastructure
â”‚   â””â”€â”€ application/   # Tests de servicios (25+ test cases)
â”œâ”€â”€ examples/          # Ejemplos de uso
â”‚   â””â”€â”€ volume_profile/ # Ejemplo completo Volume Profile
â”œâ”€â”€ requirements.txt   # Dependencias simplificadas
â”œâ”€â”€ docker-compose.yml # Setup VPS-ready
â”œâ”€â”€ Dockerfile         # Imagen optimizada
â”œâ”€â”€ Makefile           # Comandos esenciales
â”œâ”€â”€ verify_setup.py    # Script de verificaciÃ³n
â””â”€â”€ .env.example       # Variables mÃ­nimas
```

## âœ… Decisiones Tomadas
- MongoDB para time-series data
- WebSocket para recolecciÃ³n
- MCP Protocol para distribuciÃ³n
- Docker Compose para deployment
- API Keys para autenticaciÃ³n
- **Puerto API**: 8920 (no estÃ¡ndar, evita conflictos con Plesk)
- **URLs**: https://tu-dominio.com:8920/* (con SSL)

## â“ Decisiones Pendientes
1. Timeframes a soportar (Â¿solo 1h o multi-timeframe?) âœ… Resuelto: Multi-timeframe
2. SÃ­mbolos iniciales (Â¿BTC, ETH, SOL o mÃ¡s?) - Pendiente
3. Frecuencia de actualizaciÃ³n cliente (Â¿1min, 5min?) - Pendiente
4. RetenciÃ³n de datos (Â¿7d, 30d?) - Pendiente
5. Procesamiento: Â¿buffer memoria o Redis Streams? âœ… Resuelto: Redis cache con TTL

## ğŸ“Š Indicadores Implementados
**Volume Profile**: âœ… COMPLETADO
- POC (Point of Control) - Precio con mayor volumen
- VAH (Value Area High) - LÃ­mite superior del 70% de volumen
- VAL (Value Area Low) - LÃ­mite inferior del 70% de volumen
- DistribuciÃ³n por precio con tick size automÃ¡tico
- AnÃ¡lisis multi-timeframe (5m, 15m, 30m, 1h, 4h, 1d)
- Cache Redis especializado con TTL optimizado
- API REST con 6 endpoints completos

**Order Flow**: ğŸ“… PrÃ³ximo (TASK-005)
- Delta y Delta acumulativo
- Imbalance ratio
- Large trades detection
- AbsorciÃ³n detection

## ğŸ Stack TecnolÃ³gico
- Python 3.11 + FastAPI + Pydantic v2
- MongoDB + TTL automÃ¡tico para time-series
- Redis Cache especializado para Volume Profile
- Repository pattern + Clean Architecture
- WebSocket collectors (Binance/Bybit)
- Docker + Docker Compose
- Logging estructurado con structlog

## ğŸ“ˆ Progreso: 50% (4/8 tareas completadas)

## ğŸš€ PrÃ³ximos Pasos
1. [TASK-005] Order Flow Analyzer (4h) - PrÃ³xima tarea
2. [TASK-006] FastMCP Tools Implementation (6h)
3. [TASK-007] Sistema de Alertas (3h)
4. [TASK-008] Historical Data Backfill (2h)

## ğŸ“ Archivos Clave
- `claude/master-log.md` - Historial completo del proyecto
- `claude/tasks/task-tracker.md` - Estado de todas las tareas
- `claude/adr/` - Decisiones arquitectÃ³nicas
- `claude/docs/` - DocumentaciÃ³n tÃ©cnica nueva
  - `arquitectura-simplificada.md` - DiseÃ±o del sistema
  - `deployment-vps.md` - GuÃ­a de deployment
  - `api-reference.md` - Referencia de API
- `src/application/services/volume_profile_service.py` - Servicio principal Volume Profile
- `src/presentation/api/routes/volume_profile.py` - API REST endpoints
- `tests/application/services/test_volume_profile_service.py` - Tests exhaustivos
- `examples/volume_profile/volume_profile_example.py` - Ejemplo completo
- `requirements.txt` - Dependencias simplificadas
- `docker-compose.yml` - Setup VPS-ready

## ğŸ¯ Funcionalidades Volume Profile Implementadas
- **Algoritmos Core**: POC/VAH/VAL calculation con expansiÃ³n simÃ©trica
- **Multi-timeframe**: 5m, 15m, 30m, 1h, 4h, 1d support
- **Tick Size AutomÃ¡tico**: BTC/ETH: 0.01, USDT: 0.001, otros: 0.0001
- **Cache Redis**: TTL optimizado (1min real-time, 5min calculated, 10min historical)
- **API REST**: 6 endpoints con validaciÃ³n Pydantic v2
- **Use Cases**: Clean Architecture con inyecciÃ³n de dependencias
- **Tests**: 25+ test cases con cobertura completa
- **Trading Insights**: Niveles soporte/resistencia automÃ¡ticos

---
*Contexto actualizado para desarrollo continuo del proyecto WADM*
