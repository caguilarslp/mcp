# BUG-001: Errores de ImportaciÃ³n y Dependencias - Sistema No Funcional

## ğŸš¨ Criticidad: ALTA - Sistema completo no funcional

### ğŸ“ DescripciÃ³n del Problema

El sistema WADM no puede iniciar debido a mÃºltiples errores de importaciÃ³n y dependencias mal configuradas. A pesar de haber implementado correctamente TASK-001 a TASK-005, el sistema no arranca.

### ğŸ”§ Progreso de ResoluciÃ³n

#### âœ… Arreglos Completados
1. **core/algorithms/__init__.py** - AÃ±adido import de VolumeProfileCalculator
2. **application/use_cases/order_flow/__init__.py** - Creado mÃ³dulo completo con todos los use cases
3. **infrastructure/database/repositories.py** - AÃ±adidas funciones factory (get_trade_repository, etc.)
4. **infrastructure/cache/redis_cache.py** - AÃ±adida funciÃ³n get_redis_cache
5. **DocumentaciÃ³n de API creada**:
   - claude/docs/order-flow-api-examples.md - Ejemplos completos de respuestas
   - claude/docs/volume-profile-api-examples.md - Ejemplos completos de respuestas

#### â³ Pendiente de VerificaciÃ³n
- Probar que Docker Compose arranque sin errores
- Verificar que todos los endpoints funcionen
- Confirmar que no hay mÃ¡s errores de importaciÃ³n

### ğŸ› Errores Identificados (RESUELTOS)

1. **ModuleNotFoundError: 'src.core.algorithms.volume_profile_calculator'**
   - Archivo: `/app/src/core/algorithms/__init__.py:2`
   - Causa: Import de mÃ³dulo que no existe o estÃ¡ mal ubicado

2. **ImportError: cannot import name 'TimeFrame' from 'src.core.entities'**
   - Archivo: `/app/src/application/services/order_flow_service.py:25`
   - Causa: TimeFrame no estÃ¡ exportado correctamente desde entities

3. **ModuleNotFoundError: No module named 'src.presentation.core'**
   - Archivo: `/app/src/presentation/api/routes/order_flow.py:18`
   - Causa: Import relativo incorrecto (...core.entities deberÃ­a ser absoluto)

4. **ModuleNotFoundError: No module named 'src.application.algorithms'**
   - Archivo: `/app/src/application/services/order_flow_service.py:18`
   - Causa: Import path incorrecto (corregido pero pueden haber mÃ¡s)

### ğŸ¯ Objetivo de la Tarea

**Hacer que TODO el sistema funcione completamente sin mocks, sin trucos, sin APIs mÃ­nimas.**

El sistema debe:
- âœ… Arrancar Docker Compose sin errores
- âœ… Tener todos los servicios funcionando (MongoDB + Redis + API)
- âœ… Responder a TODOS los endpoints implementados
- âœ… Mostrar Swagger docs en http://localhost:8920/docs
- âœ… Ejecutar todos los endpoints de Volume Profile (TASK-004)
- âœ… Ejecutar todos los endpoints de Order Flow (TASK-005)
- âœ… Usar las implementaciones reales (no mocks)

### ğŸ“‹ Tareas EspecÃ­ficas a Resolver

#### 1. **Arreglar Estructura de Imports**
- [ ] Revisar TODOS los imports en el proyecto
- [ ] Cambiar imports relativos a absolutos donde sea necesario
- [ ] Verificar que todos los mÃ³dulos existan donde se importan
- [ ] Consolidar exports en `__init__.py` files

#### 2. **Arreglar Volume Profile Integration**
- [ ] Verificar que VolumeProfileCalculator estÃ© en el lugar correcto
- [ ] Asegurar que volume_profile_service.py importe correctamente
- [ ] Verificar que todos los endpoints de Volume Profile funcionen

#### 3. **Arreglar Order Flow Integration** 
- [ ] Verificar que OrderFlowCalculator estÃ© correctamente ubicado
- [ ] Asegurar que order_flow_service.py importe correctamente
- [ ] Verificar que todos los endpoints de Order Flow funcionen

#### 4. **Arreglar Types y Entities**
- [ ] Consolidar todas las entidades necesarias en entities.py
- [ ] Asegurar que TimeFrame, Symbol, Exchange estÃ©n disponibles
- [ ] Verificar aliases (TradeData = Trade, etc.)

#### 5. **Arreglar API Layer**
- [ ] Verificar que main.py importe correctamente todos los routers
- [ ] Asegurar que routes/order_flow.py use imports correctos
- [ ] Verificar que routes/volume_profile.py funcione

#### 6. **Arreglar Infrastructure Layer**
- [ ] Verificar que repositories estÃ©n correctamente implementados
- [ ] Asegurar que redis_cache.py importe correctamente
- [ ] Verificar conexiones a MongoDB y Redis

### ğŸ”§ Archivos que Necesitan RevisiÃ³n/CorrecciÃ³n

```
src/
â”œâ”€â”€ core/
â”‚   â”œâ”€â”€ entities.py âš ï¸ (TimeFrame exports)
â”‚   â”œâ”€â”€ types.py âœ… (parece OK)
â”‚   â””â”€â”€ algorithms/
â”‚       â”œâ”€â”€ __init__.py âš ï¸ (imports incorrectos)
â”‚       â”œâ”€â”€ volume_profile_calculator.py â“ (existe?)
â”‚       â””â”€â”€ order_flow_calculator.py âœ…
â”œâ”€â”€ application/
â”‚   â”œâ”€â”€ services/
â”‚   â”‚   â”œâ”€â”€ volume_profile_service.py â“ (verificar imports)
â”‚   â”‚   â””â”€â”€ order_flow_service.py âš ï¸ (TimeFrame imports)
â”‚   â””â”€â”€ use_cases/ â“ (verificar estructura)
â”œâ”€â”€ infrastructure/
â”‚   â”œâ”€â”€ cache/
â”‚   â”‚   â””â”€â”€ redis_cache.py âš ï¸ (imports OrderFlowProfile)
â”‚   â””â”€â”€ database/ â“ (verificar repositories)
â””â”€â”€ presentation/
    â””â”€â”€ api/
        â”œâ”€â”€ main.py âš ï¸ (router imports)
        â””â”€â”€ routes/
            â”œâ”€â”€ volume_profile.py â“ (verificar)
            â””â”€â”€ order_flow.py âš ï¸ (import relativos)
```

### ğŸ“Š Estado Actual

- **TASK-001**: âœ… Completada (Docker setup)
- **TASK-002**: âœ… Completada (WebSocket collectors)  
- **TASK-003**: âœ… Completada (MongoDB schemas)
- **TASK-004**: âœ… Completada (Volume Profile) - PERO NO FUNCIONA
- **TASK-005**: âœ… Completada (Order Flow) - PERO NO FUNCIONA

**Progreso Real: 0% funcional** a pesar de 62.5% implementado.

### ğŸ¯ DefiniciÃ³n de Ã‰xito

La tarea estarÃ¡ completa cuando:

1. **Docker Compose inicia sin errores**:
   ```bash
   docker-compose up -d
   # NO debe mostrar errores de import
   ```

2. **API responde correctamente**:
   ```bash
   curl http://localhost:8920/health
   # Debe retornar 200 OK
   ```

3. **Swagger docs cargan completamente**:
   ```bash
   http://localhost:8920/docs
   # Debe mostrar TODOS los endpoints implementados
   ```

4. **Endpoints funcionan con datos reales**:
   ```bash
   curl "http://localhost:8920/api/v1/volume-profile/current/BTCUSDT"
   curl "http://localhost:8920/api/v1/order-flow/current/BTCUSDT"
   # Deben retornar JSON vÃ¡lido (aunque sea con datos vacÃ­os)
   ```

5. **Logs muestran inicializaciÃ³n correcta**:
   ```bash
   docker-compose logs wadm-api
   # Debe mostrar "Application started successfully"
   ```

### âš ï¸ Restricciones

- **NO usar mocks ni APIs mÃ­nimas**
- **NO omitir funcionalidades ya implementadas**
- **NO cambiar la arquitectura existente**
- **Solo arreglar imports y dependencias**
- **Mantener toda la funcionalidad de TASK-004 y TASK-005**

### ğŸ“… Prioridad

**URGENTE** - Debe completarse antes de continuar con TASK-006.

### ğŸ·ï¸ Labels

- `bug`
- `critical`
- `imports`
- `dependencies`
- `docker`
- `infrastructure`

---

**Esta tarea debe resolver todos los problemas de imports para que el sistema funcione al 100% como estÃ¡ diseÃ±ado.**
